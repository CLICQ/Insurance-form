(function(){function u(n){throw n;}function s(n){return function(){return n}}function h(h){function gt(n,i,u,f,e){var o=[];return n=l.j(function(){var n=i(u,e)||[];0<o.length&&(l.a.Ya(k(o),n),f&&l.r.K(f,t,[u,n,e])),o.splice(0,o.length),l.a.P(o,n)},t,{W:n,Ka:function(){return 0==o.length||!l.a.X(o[0])}}),{M:o,j:n.pa()?n:r}}function k(n){for(;n.length&&!l.a.X(n[0]);)n.splice(0,1);if(1<n.length){for(var t=n[0],r=n[n.length-1],i=[t];t!==r;){if(t=t.nextSibling,!t)return;i.push(t)}Array.prototype.splice.apply(n,[0,n.length].concat(i))}return n}function ut(n,t,i,r,u){for(var o=Math.min,l=Math.max,s=[],a=n.length,f,h=t.length,c=h-a||1,w=a+h+1,v,p,b,y,e=0;e<=a;e++)for(p=v,s.push(v=[]),b=o(h,e+c),f=l(0,e-1);f<=b;f++)v[f]=f?e?n[e-1]===t[f-1]?p[f-1]:o(p[f]||w,v[f-1]||w)+1:f+1:e+1;for(o=[],l=[],c=[],e=a,f=h;e||f;)h=s[e][f]-1,f&&h===s[e][f-1]?l.push(o[o.length]={status:i,value:t[--f],index:f}):e&&h===s[e-1][f]?c.push(o[o.length]={status:r,value:n[--e],index:e}):(o.push({status:"retained",value:t[--f]}),--e);if(l.length&&c.length)for(n=10*a,t=i=0;(u||t<n)&&(y=l[i]);i++){for(r=0;s=c[r];r++)if(y.value===s.value){y.moved=s.index,s.moved=y.index,c.splice(r,1),t=r=0;break}t+=r}return o.reverse()}function ft(r,f,e,o,s){s=s||{};var h=r&&d(r),h=h&&h.ownerDocument,c=s.templateEngine||rt;l.za.vb(e,c,h),e=c.renderTemplate(e,o,s,h),("number"!=typeof e.length||0<e.length&&"number"!=typeof e[0].nodeType)&&u(Error("Template engine must return an array of DOM nodes")),h=i;switch(f){case"replaceChildren":l.e.N(r,e),h=n;break;case"replaceNode":l.a.Ya(r,e),h=n;break;case"ignoreTargetNode":break;default:u(Error("Unknown renderMode: "+f))}return h&&(et(e,o),s.afterRender&&l.r.K(s.afterRender,t,[e,o.$data])),e}function d(n){return n.nodeType?n:0<n.length?n[0]:t}function et(n,t){if(n.length){var i=n[0],r=n[n.length-1];ot(i,r,function(n){l.Da(t,n)}),ot(i,r,function(n){l.s.ib(n,[t])})}}function ot(n,t,i){var r;for(t=l.e.nextSibling(t);n&&(r=n)!==t;)n=l.e.nextSibling(r),(1===r.nodeType||8===r.nodeType)&&i(r)}function st(n,t,i){var o,f,r,e;for(n=l.g.aa(n),o=l.g.Q,f=0;f<n.length;f++)r=n[f].key,o.hasOwnProperty(r)&&(e=o[r],"function"==typeof e?(r=e(n[f].value))&&u(Error(r)):e||u(Error("This template engine does not support the '"+r+"' binding within its templates")));return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+l.g.ba(n)+" } })()})",i.createJavaScriptEvaluatorBlock(n)+t}function ht(n,i,f,e){function c(n){return function(){return o[n]}}function a(){return o}var s=0,o,h;return l.j(function(){var y=f&&f instanceof l.z?f:new l.z(l.a.d(f)),p=y.$data,t,v;if(e&&l.eb(n,y),o=("function"==typeof i?i(y,n):i)||l.J.instance.getBindings(n,y)){if(0===s){s=1;for(t in o)v=l.c[t],v&&8===n.nodeType&&!l.e.I[t]&&u(Error("The binding '"+t+"' cannot be used with virtual elements")),v&&"function"==typeof v.init&&(v=v.init(n,c(t),a,p,y))&&v.controlsDescendantBindings&&(h!==r&&u(Error("Multiple bindings ("+h+" and "+t+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.")),h=t);s=2}if(2===s)for(t in o)(v=l.c[t])&&"function"==typeof v.update&&v.update(n,c(t),a,p,y)}},t,{W:n}),{Nb:h===r}}function ct(i,r,u){var e=n,f=1===r.nodeType;f&&l.e.Ta(r),(f&&u||l.J.instance.nodeHasBindings(r))&&(e=ht(r,t,i,u).Nb),e&&lt(i,r,!f)}function lt(n,t,i){for(var r=l.e.firstChild(t);t=r;)r=l.e.nextSibling(t),ct(n,t,i)}function at(n,i){var r=vt(n,i);return r?0<r.length?r[r.length-1].nextSibling:n.nextSibling:t}function vt(n,i){for(var r=n,f=1,e=[];r=r.nextSibling;){if(p(r)&&(f--,0===f))return e;e.push(r),a(r)&&f++}return i||u(Error("Cannot find closing comment tag to match: "+n.nodeValue)),t}function p(n){return 8==n.nodeType&&(b?n.text:n.nodeValue).match(fi)}function a(n){return 8==n.nodeType&&(b?n.text:n.nodeValue).match(ui)}function g(n,i){for(var r=t;n!=r;)r=n,n=n.replace(ti,function(n,t){return i[t]});return n}function ni(){var n=[],t=[];this.save=function(i,r){var u=l.a.i(n,i);0<=u?t[u]=r:(n.push(i),t.push(r))},this.get=function(i){return i=l.a.i(n,i),0<=i?t[i]:r}}function yt(n,i,u){function s(t){var f=i(n[t]),o;switch(typeof f){case"boolean":case"number":case"string":case"function":e[t]=f;break;case"object":case"undefined":o=u.get(f),e[t]=o!==r?o:yt(f,i,u)}}var e,o,f;if(u=u||new ni,n=i(n),!("object"==typeof n&&n!==t&&n!==r&&!(n instanceof Date)))return n;if(e=n instanceof Array?[]:{},u.save(n,e),o=n,o instanceof Array){for(f=0;f<o.length;f++)s(f);"function"==typeof o.toJSON&&s("toJSON")}else for(f in o)s(f);return e}function pt(n,i){var r;if(n)if(8==n.nodeType)r=l.s.Ua(n.nodeValue),r!=t&&i.push({sb:n,Fb:r});else if(1==n.nodeType)for(var r=0,u=n.childNodes,f=u.length;r<f;r++)pt(u[r],i)}function nt(t,r,u,f){l.c[t]={init:function(t){return l.a.f.set(t,it,{}),{controlsDescendantBindings:n}},update:function(t,i,e,o,s){e=l.a.f.get(t,it),i=l.a.d(i()),o=!u!=!i;var h=!e.Za;(h||r||o!==e.qb)&&(h&&(e.Za=l.a.Ia(l.e.childNodes(t),n)),o?(h||l.e.N(t,l.a.Ia(e.Za)),l.Ea(f?f(s,i):s,t)):l.e.Y(t),e.qb=o)}},l.g.Q[t]=i,l.e.I[t]=n}function wt(n,i,r){r&&i!==l.k.q(n)&&l.k.T(n,i),i!==l.k.q(n)&&l.r.K(l.a.Ba,t,[n,"change"])}var l="undefined"!=typeof h?h:{},w,v,bt,y,tt,it,kt,dt,rt;l.b=function(n,t){for(var i=n.split("."),r=l,u=0;u<i.length-1;u++)r=r[i[u]];r[i[i.length-1]]=t},l.p=function(n,t,i){n[t]=i},l.version="2.2.1",l.b("version",l.version),l.a=new function(){function p(n,t){if("input"!==l.a.u(n)||!n.type||"click"!=t.toLowerCase())return i;var r=n.type;return"checkbox"==r||"radio"==r}var d=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,h={},w={},a,v,y,b,k,s;h[/Firefox\/2/i.test(c.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],h.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");for(a in h)if(v=h[a],v.length)for(y=0,b=v.length;y<b;y++)w[v[y]]=a;for(k={propertychange:n},h=3,a=e.createElement("div"),v=a.getElementsByTagName("i");a.innerHTML="<!--[if gt IE "+ ++h+"]><i><\/i><![endif]-->",v[0];);return s=4<h?h:r,{Na:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],o:function(n,t){for(var i=0,r=n.length;i<r;i++)t(n[i])},i:function(n,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(n,t);for(var i=0,r=n.length;i<r;i++)if(n[i]===t)return i;return-1},lb:function(n,i,r){for(var u=0,f=n.length;u<f;u++)if(i.call(r,n[u]))return n[u];return t},ga:function(n,t){var i=l.a.i(n,t);0<=i&&n.splice(i,1)},Ga:function(n){n=n||[];for(var i=[],t=0,r=n.length;t<r;t++)0>l.a.i(i,n[t])&&i.push(n[t]);return i},V:function(n,t){n=n||[];for(var r=[],i=0,u=n.length;i<u;i++)r.push(t(n[i]));return r},fa:function(n,t){n=n||[];for(var r=[],i=0,u=n.length;i<u;i++)t(n[i])&&r.push(n[i]);return r},P:function(n,t){if(t instanceof Array)n.push.apply(n,t);else for(var i=0,r=t.length;i<r;i++)n.push(t[i]);return n},extend:function(n,t){if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},ka:function(n){for(;n.firstChild;)l.removeNode(n.firstChild)},Hb:function(n){n=l.a.L(n);for(var i=e.createElement("div"),t=0,r=n.length;t<r;t++)i.appendChild(l.A(n[t]));return i},Ia:function(t,i){for(var u,r=0,e=t.length,f=[];r<e;r++)u=t[r].cloneNode(n),f.push(i?l.A(u):u);return f},N:function(n,t){if(l.a.ka(n),t)for(var i=0,r=t.length;i<r;i++)n.appendChild(t[i])},Ya:function(n,t){var r=n.nodeType?[n]:n;if(0<r.length){for(var f=r[0],e=f.parentNode,i=0,u=t.length;i<u;i++)e.insertBefore(t[i],f);for(i=0,u=r.length;i<u;i++)l.removeNode(r[i])}},bb:function(n,t){7>s?n.setAttribute("selected",t):n.selected=t},D:function(n){return(n||"").replace(d,"")},Rb:function(n,t){for(var r,u=[],f=(n||"").split(t),i=0,e=f.length;i<e;i++)r=l.a.D(f[i]),""!==r&&u.push(r);return u},Ob:function(n,t){return n=n||"",t.length>n.length?i:n.substring(0,t.length)===t},tb:function(r,u){if(u.compareDocumentPosition)return 16==(u.compareDocumentPosition(r)&16);for(;r!=t;){if(r==u)return n;r=r.parentNode}return i},X:function(n){return l.a.tb(n,n.ownerDocument)},u:function(n){return n&&n.tagName&&n.tagName.toLowerCase()},n:function(t,r,e){var o=s&&k[r],h;o||"undefined"==typeof f?!o&&"function"==typeof t.addEventListener?t.addEventListener(r,e,i):"undefined"!=typeof t.attachEvent?t.attachEvent("on"+r,function(n){e.call(t,n)}):u(Error("Browser doesn't support addEventListener or attachEvent")):(p(t,r)&&(h=e,e=function(t,i){var r=this.checked;i&&(this.checked=i.nb!==n),h.call(this,t),this.checked=r}),f(t).bind(r,e))},Ba:function(t,r){if(t&&t.nodeType||u(Error("element must be a DOM node when calling triggerEvent")),"undefined"!=typeof f){var s=[];p(t,r)&&s.push({nb:t.checked}),f(t).trigger(r,s)}else"function"==typeof e.createEvent?"function"==typeof t.dispatchEvent?(s=e.createEvent(w[r]||"HTMLEvents"),s.initEvent(r,n,n,o,0,0,0,0,0,i,i,i,i,0,t),t.dispatchEvent(s)):u(Error("The supplied element doesn't support dispatchEvent")):"undefined"!=typeof t.fireEvent?(p(t,r)&&(t.checked=t.checked!==n),t.fireEvent("on"+r)):u(Error("Browser doesn't support triggering events"))},d:function(n){return l.$(n)?n():n},ua:function(n){return l.$(n)?n.t():n},da:function(n,t,i){if(t){var u=/[\w-]+/g,r=n.className.match(u)||[];l.a.o(t.match(u),function(n){var t=l.a.i(r,n);0<=t?i||r.splice(t,1):i&&r.push(n)}),n.className=r.join(" ")}},cb:function(n,i){var u=l.a.d(i),f;(u===t||u===r)&&(u=""),3===n.nodeType?n.data=u:(f=l.e.firstChild(n),!f||3!=f.nodeType||l.e.nextSibling(f)?l.e.N(n,[e.createTextNode(u)]):f.data=u,l.a.wb(n))},ab:function(n,t){if(n.name=t,7>=s)try{n.mergeAttributes(e.createElement("<input name='"+n.name+"'/>"),i)}catch(r){}},wb:function(n){9<=s&&(n=1==n.nodeType?n:n.parentNode,n.style&&(n.style.zoom=n.style.zoom))},ub:function(n){if(9<=s){var t=n.style.width;n.style.width=0,n.style.width=t}},Lb:function(n,t){n=l.a.d(n),t=l.a.d(t);for(var r=[],i=n;i<=t;i++)r.push(i);return r},L:function(n){for(var i=[],t=0,r=n.length;t<r;t++)i.push(n[t]);return i},Pb:6===s,Qb:7===s,Z:s,Oa:function(n,t){for(var r=l.a.L(n.getElementsByTagName("input")).concat(l.a.L(n.getElementsByTagName("textarea"))),f="string"==typeof t?function(n){return n.name===t}:function(n){return t.test(n.name)},u=[],i=r.length-1;0<=i;i--)f(r[i])&&u.push(r[i]);return u},Ib:function(n){return"string"==typeof n&&(n=l.a.D(n))?o.JSON&&o.JSON.parse?o.JSON.parse(n):new Function("return "+n)():t},xa:function(n,t,i){return("undefined"==typeof JSON||"undefined"==typeof JSON.stringify)&&u(Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js")),JSON.stringify(l.a.d(n),t,i)},Jb:function(n,t,i){var a,o,s,f,r,u;i=i||{};var h=i.params||{},c=i.includeFields||this.Na,a=n;if("object"==typeof n&&"form"===l.a.u(n))for(a=n.action,o=c.length-1;0<=o;o--)for(s=l.a.Oa(n,c[o]),f=s.length-1;0<=f;f--)h[s[f].name]=s[f].value;t=l.a.d(t),r=e.createElement("form"),r.style.display="none",r.action=a,r.method="post";for(u in t)n=e.createElement("input"),n.name=u,n.value=l.a.xa(l.a.d(t[u])),r.appendChild(n);for(u in h)n=e.createElement("input"),n.name=u,n.value=h[u],r.appendChild(n);e.body.appendChild(r),i.submitter?i.submitter(r):r.submit(),setTimeout(function(){r.parentNode.removeChild(r)},0)}}},l.b("utils",l.a),l.b("utils.arrayForEach",l.a.o),l.b("utils.arrayFirst",l.a.lb),l.b("utils.arrayFilter",l.a.fa),l.b("utils.arrayGetDistinctValues",l.a.Ga),l.b("utils.arrayIndexOf",l.a.i),l.b("utils.arrayMap",l.a.V),l.b("utils.arrayPushAll",l.a.P),l.b("utils.arrayRemoveItem",l.a.ga),l.b("utils.extend",l.a.extend),l.b("utils.fieldsIncludedWithJsonPost",l.a.Na),l.b("utils.getFormFields",l.a.Oa),l.b("utils.peekObservable",l.a.ua),l.b("utils.postJson",l.a.Jb),l.b("utils.parseJson",l.a.Ib),l.b("utils.registerEventHandler",l.a.n),l.b("utils.stringifyJson",l.a.xa),l.b("utils.range",l.a.Lb),l.b("utils.toggleDomNodeCssClass",l.a.da),l.b("utils.triggerEvent",l.a.Ba),l.b("utils.unwrapObservable",l.a.d),Function.prototype.bind||(Function.prototype.bind=function(n){var i=this,t=Array.prototype.slice.call(arguments);return n=t.shift(),function(){return i.apply(n,t.concat(Array.prototype.slice.call(arguments)))}}),l.a.f=new function(){var e=0,u="__ko__"+ +new Date,f={};return{get:function(n,t){var u=l.a.f.la(n,i);return u===r?r:u[t]},set:function(t,u,f){f===r&&l.a.f.la(t,i)===r||(l.a.f.la(t,n)[u]=f)},la:function(n,t){var i=n[u];if(!i||!("null"!==i&&f[i])){if(!t)return r;i=n[u]="ko"+e++,f[i]={}}return f[i]},clear:function(r){var e=r[u];return e?(delete f[e],r[u]=t,n):i}}},l.b("utils.domData",l.a.f),l.b("utils.domData.clear",l.a.f.clear),l.a.F=new function(){function t(n,t){var i=l.a.f.get(n,o);return i===r&&t&&(i=[],l.a.f.set(n,o,i)),i}function e(n){var r=t(n,i),u;if(r)for(r=r.slice(0),u=0;u<r.length;u++)r[u](n);if(l.a.f.clear(n),"function"==typeof f&&"function"==typeof f.cleanData&&f.cleanData([n]),s[n.nodeType])for(r=n.firstChild;n=r;)r=n.nextSibling,8===n.nodeType&&e(n)}var o="__ko_domNodeDisposal__"+ +new Date,h={1:n,8:n,9:n},s={1:n,9:n};return{Ca:function(i,r){"function"!=typeof r&&u(Error("Callback must be a function")),t(i,n).push(r)},Xa:function(n,u){var f=t(n,i);f&&(l.a.ga(f,u),0==f.length&&l.a.f.set(n,o,r))},A:function(n){var t,i,r;if(h[n.nodeType]&&(e(n),s[n.nodeType]))for(t=[],l.a.P(t,n.getElementsByTagName("*")),i=0,r=t.length;i<r;i++)e(t[i]);return n},removeNode:function(n){l.A(n),n.parentNode&&n.parentNode.removeChild(n)}}},l.A=l.a.F.A,l.removeNode=l.a.F.removeNode,l.b("cleanNode",l.A),l.b("removeNode",l.removeNode),l.b("utils.domNodeDisposal",l.a.F),l.b("utils.domNodeDisposal.addDisposeCallback",l.a.F.Ca),l.b("utils.domNodeDisposal.removeDisposeCallback",l.a.F.Xa),l.a.ta=function(n){var t,i;if("undefined"!=typeof f){if(f.parseHTML)t=f.parseHTML(n);else if((t=f.clean([n]))&&t[0]){for(n=t[0];n.parentNode&&11!==n.parentNode.nodeType;)n=n.parentNode;n.parentNode&&n.parentNode.removeChild(n)}}else{for(i=l.a.D(n).toLowerCase(),t=e.createElement("div"),i=i.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","<\/table>"]||!i.indexOf("<tr")&&[2,"<table><tbody>","<\/tbody><\/table>"]||(!i.indexOf("<td")||!i.indexOf("<th"))&&[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"]||[0,"",""],n="ignored<div>"+i[1]+n+i[2]+"<\/div>","function"==typeof o.innerShiv?t.appendChild(o.innerShiv(n)):t.innerHTML=n;i[0]--;)t=t.lastChild;t=l.a.L(t.lastChild.childNodes)}return t},l.a.ca=function(n,i){if(l.a.ka(n),i=l.a.d(i),i!==t&&i!==r)if("string"!=typeof i&&(i=i.toString()),"undefined"!=typeof f)f(n).html(i);else for(var e=l.a.ta(i),u=0;u<e.length;u++)n.appendChild(e[u])},l.b("utils.parseHtmlFragment",l.a.ta),l.b("utils.setHtml",l.a.ca),w={},l.s={ra:function(n){"function"!=typeof n&&u(Error("You can only pass a function to ko.memoization.memoize()"));var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return w[t]=n,"<!--[ko_memo:"+t+"]-->"},hb:function(i,f){var e=w[i];e===r&&u(Error("Couldn't find any memo with ID "+i+". Perhaps it's already been unmemoized."));try{return e.apply(t,f||[]),n}finally{delete w[i]}},ib:function(n,t){var u=[],r,e,i,f;for(pt(n,u),r=0,e=u.length;r<e;r++)i=u[r].sb,f=[i],t&&l.a.P(f,t),l.s.hb(u[r].Fb,f),i.nodeValue="",i.parentNode&&i.parentNode.removeChild(i)},Ua:function(n){return(n=n.match(/^\[ko_memo\:(.*?)\]$/))?n[1]:t}},l.b("memoization",l.s),l.b("memoization.memoize",l.s.ra),l.b("memoization.unmemoize",l.s.hb),l.b("memoization.parseMemoText",l.s.Ua),l.b("memoization.unmemoizeDomNodeAndDescendants",l.s.ib),l.Ma={throttle:function(n,i){n.throttleEvaluation=i;var r=t;return l.j({read:n,write:function(t){clearTimeout(r),r=setTimeout(function(){n(t)},i)}})},notify:function(n,t){return n.equalityComparer="always"==t?s(i):l.m.fn.equalityComparer,n}},l.b("extenders",l.Ma),l.fb=function(n,t,i){this.target=n,this.ha=t,this.rb=i,l.p(this,"dispose",this.B)},l.fb.prototype.B=function(){this.Cb=n,this.rb()},l.S=function(){this.w={},l.a.extend(this,l.S.fn),l.p(this,"subscribe",this.ya),l.p(this,"extend",this.extend),l.p(this,"getSubscriptionsCount",this.yb)},l.S.fn={ya:function(n,t,i){i=i||"change";var r=new l.fb(this,t?n.bind(t):n,function(){l.a.ga(this.w[i],r)}.bind(this));return this.w[i]||(this.w[i]=[]),this.w[i].push(r),r},notifySubscribers:function(t,i){i=i||"change",this.w[i]&&l.r.K(function(){l.a.o(this.w[i].slice(0),function(i){i&&i.Cb!==n&&i.ha(t)})},this)},yb:function(){var t=0,n;for(n in this.w)this.w.hasOwnProperty(n)&&(t+=this.w[n].length);return t},extend:function(n){var t=this,i,r;if(n)for(i in n)r=l.Ma[i],"function"==typeof r&&(t=r(t,n[i]));return t}},l.Qa=function(n){return"function"==typeof n.ya&&"function"==typeof n.notifySubscribers},l.b("subscribable",l.S),l.b("isSubscribable",l.Qa),v=[],l.r={mb:function(n){v.push({ha:n,La:[]})},end:function(){v.pop()},Wa:function(n){if(l.Qa(n)||u(Error("Only subscribable things can act as dependencies")),0<v.length){var t=v[v.length-1];!t||0<=l.a.i(t.La,n)||(t.La.push(n),t.ha(n))}},K:function(n,i,r){try{return v.push(t),n.apply(i,r||[])}finally{v.pop()}}},bt={undefined:n,boolean:n,number:n,string:n},l.m=function(n){function t(){return 0<arguments.length?(t.equalityComparer&&t.equalityComparer(i,arguments[0])||(t.H(),i=arguments[0],t.G()),this):(l.r.Wa(t),i)}var i=n;return l.S.call(t),t.t=function(){return i},t.G=function(){t.notifySubscribers(i)},t.H=function(){t.notifySubscribers(i,"beforeChange")},l.a.extend(t,l.m.fn),l.p(t,"peek",t.t),l.p(t,"valueHasMutated",t.G),l.p(t,"valueWillMutate",t.H),t},l.m.fn={equalityComparer:function(n,r){return n===t||typeof n in bt?n===r:i}},y=l.m.Kb="__ko_proto__",l.m.fn[y]=l.m,l.ma=function(u,f){return u===t||u===r||u[y]===r?i:u[y]===f?n:l.ma(u[y],f)},l.$=function(n){return l.ma(n,l.m)},l.Ra=function(t){return"function"==typeof t&&t[y]===l.m||"function"==typeof t&&t[y]===l.j&&t.zb?n:i},l.b("observable",l.m),l.b("isObservable",l.$),l.b("isWriteableObservable",l.Ra),l.R=function(n){0==arguments.length&&(n=[]),n===t||n===r||"length"in n||u(Error("The argument passed when initializing an observable array must be an array, or null, or undefined."));var i=l.m(n);return l.a.extend(i,l.R.fn),i},l.R.fn={remove:function(n){for(var u,r=this.t(),i=[],f="function"==typeof n?n:function(t){return t===n},t=0;t<r.length;t++)u=r[t],f(u)&&(0===i.length&&this.H(),i.push(u),r.splice(t,1),t--);return i.length&&this.G(),i},removeAll:function(n){if(n===r){var t=this.t(),i=t.slice(0);return this.H(),t.splice(0,t.length),this.G(),i}return n?this.remove(function(t){return 0<=l.a.i(n,t)}):[]},destroy:function(t){var r=this.t(),u="function"==typeof t?t:function(n){return n===t},i;for(this.H(),i=r.length-1;0<=i;i--)u(r[i])&&(r[i]._destroy=n);this.G()},destroyAll:function(t){return t===r?this.destroy(s(n)):t?this.destroy(function(n){return 0<=l.a.i(t,n)}):[]},indexOf:function(n){var t=this();return l.a.i(t,n)},replace:function(n,t){var i=this.indexOf(n);0<=i&&(this.H(),this.t()[i]=t,this.G())}},l.a.o("pop push reverse shift sort splice unshift".split(" "),function(n){l.R.fn[n]=function(){var t=this.t();return this.H(),t=t[n].apply(t,arguments),this.G(),t}}),l.a.o(["slice"],function(n){l.R.fn[n]=function(){var t=this();return t[n].apply(t,arguments)}}),l.b("observableArray",l.R),l.j=function(f,e,o){function g(){l.a.o(a,function(n){n.B()}),a=[]}function ut(){var n=h.throttleEvaluation;n&&0<=n?(clearTimeout(it),it=setTimeout(v,n)):v()}function v(){var t,f,u;if(!k)if(p&&d())w();else{k=n;try{for(t=l.a.V(a,function(n){return n.target}),l.r.mb(function(n){var i;0<=(i=l.a.i(t,n))?t[i]=r:a.push(n.ya(ut))}),f=c.call(e),u=t.length-1;0<=u;u--)t[u]&&a.splice(u,1)[0].B();p=n,h.notifySubscribers(y,"beforeChange"),y=f}finally{l.r.end()}h.notifySubscribers(y),k=i,a.length||w()}}function h(){return 0<arguments.length?("function"==typeof tt?tt.apply(e,arguments):u(Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.")),this):(p||v(),l.r.Wa(h),y)}function nt(){return!p||0<a.length}var y,p=i,k=i,c=f,rt,d;c&&"object"==typeof c?(o=c,c=o.read):(o=o||{},c||(c=o.read)),"function"!=typeof c&&u(Error("Pass a function that returns the value of the ko.computed"));var tt=o.write,b=o.disposeWhenNodeIsRemoved||o.W||t,d=o.disposeWhen||o.Ka||s(i),w=g,a=[],it=t;return e||(e=o.owner),h.t=function(){return p||v(),y},h.xb=function(){return a.length},h.zb="function"==typeof o.write,h.B=function(){w()},h.pa=nt,l.S.call(h),l.a.extend(h,l.j.fn),l.p(h,"peek",h.t),l.p(h,"dispose",h.B),l.p(h,"isActive",h.pa),l.p(h,"getDependenciesCount",h.xb),o.deferEvaluation!==n&&v(),b&&nt()&&(w=function(){l.a.F.Xa(b,arguments.callee),g()},l.a.F.Ca(b,w),rt=d,d=function(){return!l.a.X(b)||rt()}),h},l.Bb=function(n){return l.ma(n,l.j)},h=l.m.Kb,l.j[h]=l.m,l.j.fn={},l.j.fn[h]=l.j,l.b("dependentObservable",l.j),l.b("computed",l.j),l.b("isComputed",l.Bb),l.gb=function(n){return 0==arguments.length&&u(Error("When calling ko.toJS, pass the object you want to convert.")),yt(n,function(n){for(var t=0;l.$(n)&&10>t;t++)n=n();return n})},l.toJSON=function(n,t,i){return n=l.gb(n),l.a.xa(n,t,i)},l.b("toJS",l.gb),l.b("toJSON",l.toJSON),l.k={q:function(t){switch(l.a.u(t)){case"option":return t.__ko__hasDomDataOptionValue__===n?l.a.f.get(t,l.c.options.sa):7>=l.a.Z?t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return 0<=t.selectedIndex?l.k.q(t.options[t.selectedIndex]):r;default:return t.value}},T:function(i,u){switch(l.a.u(i)){case"option":switch(typeof u){case"string":l.a.f.set(i,l.c.options.sa,r),"__ko__hasDomDataOptionValue__"in i&&delete i.__ko__hasDomDataOptionValue__,i.value=u;break;default:l.a.f.set(i,l.c.options.sa,u),i.__ko__hasDomDataOptionValue__=n,i.value="number"==typeof u?u:""}break;case"select":for(var f=i.options.length-1;0<=f;f--)if(l.k.q(i.options[f])==u){i.selectedIndex=f;break}break;default:(u===t||u===r)&&(u=""),i.value=u}}},l.b("selectExtensions",l.k),l.b("selectExtensions.readValue",l.k.q),l.b("selectExtensions.writeValue",l.k.T);var ti=/\@ko_token_(\d+)\@/g,ii=["true","false"],ri=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i;l.g={Q:[],aa:function(n){var i=l.a.D(n),f,e,r,u;if(3>i.length)return[];for("{"===i.charAt(0)&&(i=i.substring(1,i.length-1)),n=[],f=t,r=0;r<i.length;r++)if(u=i.charAt(r),f===t)switch(u){case'"':case"'":case"/":f=r,e=u}else if(u==e&&"\\"!==i.charAt(r-1)){u=i.substring(f,r+1),n.push(u);var h="@ko_token_"+(n.length-1)+"@",i=i.substring(0,f)+h+i.substring(r+1),r=r-(u.length-h.length),f=t}e=f=t;for(var o=0,s=t,r=0;r<i.length;r++){if(u=i.charAt(r),f===t)switch(u){case"{":f=r,s=u,e="}";break;case"(":f=r,s=u,e=")";break;case"[":f=r,s=u,e="]"}u===s?o++:u===e&&(o--,0===o&&(u=i.substring(f,r+1),n.push(u),h="@ko_token_"+(n.length-1)+"@",i=i.substring(0,f)+h+i.substring(r+1),r-=u.length-h.length,f=t))}for(e=[],i=i.split(","),f=0,r=i.length;f<r;f++)o=i[f],s=o.indexOf(":"),0<s&&s<o.length-1?(u=o.substring(s+1),e.push({key:g(o.substring(0,s),n),value:g(u,n)})):e.push({unknown:g(o,n)});return e},ba:function(n){var e="string"==typeof n?l.g.aa(n):n,f=[],r,s,o,u;for(n=[],s=0;r=e[s];s++)if(0<f.length&&f.push(","),r.key){n:{o=r.key,u=l.a.D(o);switch(u.length&&u.charAt(0)){case"'":case'"':break n;default:o="'"+u+"'"}}r=r.value,f.push(o),f.push(":"),f.push(r),r=l.a.D(r),0<=l.a.i(ii,l.a.D(r).toLowerCase())?r=i:(u=r.match(ri),r=u===t?i:u[1]?"Object("+u[1]+")"+u[2]:r),r&&(0<n.length&&n.push(", "),n.push(o+" : function(__ko_value) { "+r+" = __ko_value; }"))}else r.unknown&&f.push(r.unknown);return e=f.join(""),0<n.length&&(e=e+", '_ko_property_writers' : { "+n.join("")+" } "),e},Eb:function(t,r){for(var u=0;u<t.length;u++)if(l.a.D(t[u].key)==r)return n;return i},ea:function(n,t,i,r,u){n&&l.Ra(n)?u&&n.t()===r||n(r):(n=t()._ko_property_writers)&&n[i]&&n[i](r)}},l.b("expressionRewriting",l.g),l.b("expressionRewriting.bindingRewriteValidators",l.g.Q),l.b("expressionRewriting.parseObjectLiteral",l.g.aa),l.b("expressionRewriting.preProcessBindings",l.g.ba),l.b("jsonExpressionRewriting",l.g),l.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",l.g.ba);var b="<!--test-->"===e.createComment("test").text,ui=b?/^\x3c!--\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*--\x3e$/:/^\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*$/,fi=b?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,ei={ul:n,ol:n};l.e={I:{},childNodes:function(n){return a(n)?vt(n):n.childNodes},Y:function(n){if(a(n)){n=l.e.childNodes(n);for(var t=0,i=n.length;t<i;t++)l.removeNode(n[t])}else l.a.ka(n)},N:function(n,t){if(a(n)){l.e.Y(n);for(var r=n.nextSibling,i=0,u=t.length;i<u;i++)r.parentNode.insertBefore(t[i],r)}else l.a.N(n,t)},Va:function(n,t){a(n)?n.parentNode.insertBefore(t,n.nextSibling):n.firstChild?n.insertBefore(t,n.firstChild):n.appendChild(t)},Pa:function(n,t,i){i?a(n)?n.parentNode.insertBefore(t,i.nextSibling):i.nextSibling?n.insertBefore(t,i.nextSibling):n.appendChild(t):l.e.Va(n,t)},firstChild:function(n){return a(n)?!n.nextSibling||p(n.nextSibling)?t:n.nextSibling:n.firstChild},nextSibling:function(n){return a(n)&&(n=at(n)),n.nextSibling&&p(n.nextSibling)?t:n.nextSibling},jb:function(n){return(n=a(n))?n[1]:t},Ta:function(i){var e,r,u,f;if(ei[l.a.u(i)]&&(e=i.firstChild,e))do if(1===e.nodeType){if(r=e.firstChild,u=t,r)do u?u.push(r):a(r)?(f=at(r,n),f?r=f:u=[r]):p(r)&&(u=[r]);while(r=r.nextSibling);if(r=u)for(u=e.nextSibling,f=0;f<r.length;f++)u?i.insertBefore(r[f],u):i.appendChild(r[f])}while(e=e.nextSibling)}},l.b("virtualElements",l.e),l.b("virtualElements.allowedBindings",l.e.I),l.b("virtualElements.emptyNode",l.e.Y),l.b("virtualElements.insertAfter",l.e.Pa),l.b("virtualElements.prepend",l.e.Va),l.b("virtualElements.setDomNodeChildren",l.e.N),l.J=function(){this.Ha={}},l.a.extend(l.J.prototype,{nodeHasBindings:function(n){switch(n.nodeType){case 1:return n.getAttribute("data-bind")!=t;case 8:return l.e.jb(n)!=t;default:return i}},getBindings:function(n,i){var r=this.getBindingsString(n,i);return r?this.parseBindingsString(r,i,n):t},getBindingsString:function(n){switch(n.nodeType){case 1:return n.getAttribute("data-bind");case 8:return l.e.jb(n);default:return t}},parseBindingsString:function(n,t,i){var r,f,e,o;try{return(r=this.Ha[n])||(f=this.Ha,o="with($context){with($data||{}){return{"+l.g.ba(n)+"}}}",e=new Function("$context","$element",o),r=f[n]=e),r(t,i)}catch(s){u(Error("Unable to parse bindings.\nMessage: "+s+";\nBindings value: "+n))}}}),l.J.instance=new l.J,l.b("bindingProvider",l.J),l.c={},l.z=function(n,t,i){t?(l.a.extend(this,t),this.$parentContext=t,this.$parent=t.$data,this.$parents=(t.$parents||[]).slice(0),this.$parents.unshift(this.$parent)):(this.$parents=[],this.$root=n,this.ko=l),this.$data=n,i&&(this[i]=n)},l.z.prototype.createChildContext=function(n,t){return new l.z(n,this,t)},l.z.prototype.extend=function(n){var t=l.a.extend(new l.z,this);return l.a.extend(t,n)},l.eb=function(n,t){if(2==arguments.length)l.a.f.set(n,"__ko_bindingContext__",t);else return l.a.f.get(n,"__ko_bindingContext__")},l.Fa=function(t,i,r){return 1===t.nodeType&&l.e.Ta(t),ht(t,i,r,n)},l.Ea=function(t,i){(1===i.nodeType||8===i.nodeType)&&lt(t,i,n)},l.Da=function(t,i){i&&1!==i.nodeType&&8!==i.nodeType&&u(Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node")),i=i||o.document.body,ct(t,i,n)},l.ja=function(n){switch(n.nodeType){case 1:case 8:var t=l.eb(n);if(t)return t;if(n.parentNode)return l.ja(n.parentNode)}return r},l.pb=function(n){return(n=l.ja(n))?n.$data:r},l.b("bindingHandlers",l.c),l.b("applyBindings",l.Da),l.b("applyBindingsToDescendants",l.Ea),l.b("applyBindingsToNode",l.Fa),l.b("contextFor",l.ja),l.b("dataFor",l.pb),tt={"class":"className","for":"htmlFor"},l.c.attr={update:function(n,u){var s=l.a.d(u())||{},f,e,o;for(f in s)"string"==typeof f&&(e=l.a.d(s[f]),o=e===i||e===t||e===r,o&&n.removeAttribute(f),8>=l.a.Z&&f in tt?(f=tt[f],o?n.removeAttribute(f):n[f]=e):o||n.setAttribute(f,e.toString()),"name"===f&&l.a.ab(n,o?"":e.toString()))}},l.c.checked={init:function(t,i,r){l.a.n(t,"click",function(){var u,f,e;if("checkbox"==t.type)u=t.checked;else if("radio"==t.type&&t.checked)u=t.value;else return;f=i(),e=l.a.d(f),"checkbox"==t.type&&e instanceof Array?(u=l.a.i(e,t.value),t.checked&&0>u?f.push(t.value):!t.checked&&0<=u&&f.splice(u,1)):l.g.ea(f,r,"checked",u,n)}),"radio"!=t.type||t.name||l.c.uniqueName.init(t,s(n))},update:function(n,t){var i=l.a.d(t());"checkbox"==n.type?n.checked=i instanceof Array?0<=l.a.i(i,n.value):i:"radio"==n.type&&(n.checked=n.value==i)}},l.c.css={update:function(t,r){var u=l.a.d(r()),f,e;if("object"==typeof u)for(f in u)e=l.a.d(u[f]),l.a.da(t,f,e);else u=String(u||""),l.a.da(t,t.__ko__cssValue,i),t.__ko__cssValue=u,l.a.da(t,u,n)}},l.c.enable={update:function(t,i){var r=l.a.d(i());r&&t.disabled?t.removeAttribute("disabled"):!r&&!t.disabled&&(t.disabled=n)}},l.c.disable={update:function(n,t){l.c.enable.update(n,function(){return!l.a.d(t())})}},l.c.event={init:function(t,r,u,f){var o=r()||{},e;for(e in o)(function(){var o=e;"string"==typeof o&&l.a.n(t,o,function(t){var s,h=r()[o],c,e;if(h){c=u();try{e=l.a.L(arguments),e.unshift(f),s=h.apply(f,e)}finally{s!==n&&(t.preventDefault?t.preventDefault():t.returnValue=i)}c[o+"Bubble"]===i&&(t.cancelBubble=n,t.stopPropagation&&t.stopPropagation())}})})()}},l.c.foreach={Sa:function(n){return function(){var i=n(),t=l.a.ua(i);return!t||"number"==typeof t.length?{foreach:i,templateEngine:l.C.oa}:(l.a.d(i),{foreach:t.data,as:t.as,includeDestroyed:t.includeDestroyed,afterAdd:t.afterAdd,beforeRemove:t.beforeRemove,afterRender:t.afterRender,beforeMove:t.beforeMove,afterMove:t.afterMove,templateEngine:l.C.oa})}},init:function(n,t){return l.c.template.init(n,l.c.foreach.Sa(t))},update:function(n,t,i,r,u){return l.c.template.update(n,l.c.foreach.Sa(t),i,r,u)}},l.g.Q.foreach=i,l.e.I.foreach=n,l.c.hasfocus={init:function(r,u,f){function e(t){r.__ko_hasfocusUpdating=n;var e=r.ownerDocument;"activeElement"in e&&(t=e.activeElement===r),e=u(),l.g.ea(e,f,"hasfocus",t,n),r.__ko_hasfocusUpdating=i}var o=e.bind(t,n),s=e.bind(t,i);l.a.n(r,"focus",o),l.a.n(r,"focusin",o),l.a.n(r,"blur",s),l.a.n(r,"focusout",s)},update:function(n,i){var r=l.a.d(i());n.__ko_hasfocusUpdating||(r?n.focus():n.blur(),l.r.K(l.a.Ba,t,[n,r?"focusin":"focusout"]))}},l.c.html={init:function(){return{controlsDescendantBindings:n}},update:function(n,t){l.a.ca(n,t())}},it="__ko_withIfBindingData",nt("if"),nt("ifnot",i,n),nt("with",n,i,function(n,t){return n.createChildContext(t)}),l.c.options={update:function(t,i,f){var c,h,a,s;"select"!==l.a.u(t)&&u(Error("options binding applies only to SELECT elements"));for(var p=0==t.length,w=l.a.V(l.a.fa(t.childNodes,function(n){return n.tagName&&"option"===l.a.u(n)&&n.selected}),function(n){return l.k.q(n)||n.innerText||n.textContent}),b=t.scrollTop,o=l.a.d(i());0<t.length;)l.A(t.options[0]),t.remove(0);if(o){for(f=f(),c=f.optionsIncludeDestroyed,"number"!=typeof o.length&&(o=[o]),f.optionsCaption&&(h=e.createElement("option"),l.a.ca(h,f.optionsCaption),l.k.T(h,r),t.appendChild(h)),i=0,a=o.length;i<a;i++)if(s=o[i],!s||!s._destroy||c){var h=e.createElement("option"),v=function(n,t,i){var r=typeof t;return"function"==r?t(n):"string"==r?n[t]:i},y=v(s,f.optionsValue,s);l.k.T(h,l.a.d(y)),s=v(s,f.optionsText,y),l.a.cb(h,s),t.appendChild(h)}for(o=t.getElementsByTagName("option"),i=c=0,a=o.length;i<a;i++)0<=l.a.i(w,l.k.q(o[i]))&&(l.a.bb(o[i],n),c++);t.scrollTop=b,p&&"value"in f&&wt(t,l.a.ua(f.value),n),l.a.ub(t)}}},l.c.options.sa="__ko.optionValueDomData__",l.c.selectedOptions={init:function(n,t,i){l.a.n(n,"change",function(){var u=t(),r=[];l.a.o(n.getElementsByTagName("option"),function(n){n.selected&&r.push(l.k.q(n))}),l.g.ea(u,i,"value",r)})},update:function(n,t){"select"!=l.a.u(n)&&u(Error("values binding applies only to SELECT elements"));var i=l.a.d(t());i&&"number"==typeof i.length&&l.a.o(n.getElementsByTagName("option"),function(n){var t=0<=l.a.i(i,l.k.q(n));l.a.bb(n,t)})}},l.c.style={update:function(n,t){var r=l.a.d(t()||{}),i,u;for(i in r)"string"==typeof i&&(u=l.a.d(r[i]),n.style[i]=u||"")}},l.c.submit={init:function(t,r,f,e){"function"!=typeof r()&&u(Error("The value for a submit binding must be a function")),l.a.n(t,"submit",function(u){var f,o=r();try{f=o.call(e,t)}finally{f!==n&&(u.preventDefault?u.preventDefault():u.returnValue=i)}})}},l.c.text={update:function(n,t){l.a.cb(n,t())}},l.e.I.text=n,l.c.uniqueName={init:function(n,t){if(t()){var i="ko_unique_"+ ++l.c.uniqueName.ob;l.a.ab(n,i)}}},l.c.uniqueName.ob=0,l.c.value={init:function(t,r,u){function o(){s=i;var n=r(),f=l.k.q(t);l.g.ea(n,u,"value",f)}var f=["change"],e=u().valueUpdate,s=i;e&&("string"==typeof e&&(e=[e]),l.a.P(f,e),f=l.a.Ga(f)),l.a.Z&&"input"==t.tagName.toLowerCase()&&"text"==t.type&&"off"!=t.autocomplete&&(!t.form||"off"!=t.form.autocomplete)&&-1==l.a.i(f,"propertychange")&&(l.a.n(t,"propertychange",function(){s=n}),l.a.n(t,"blur",function(){s&&o()})),l.a.o(f,function(n){var i=o;l.a.Ob(n,"after")&&(i=function(){setTimeout(o,0)},n=n.substring(5)),l.a.n(t,n,i)})},update:function(t,r){var e="select"===l.a.u(t),f=l.a.d(r()),u=l.k.q(t),o=f!=u;0===f&&0!==u&&"0"!==u&&(o=n),o&&(u=function(){l.k.T(t,f)},u(),e&&setTimeout(u,0)),e&&0<t.length&&wt(t,f,i)}},l.c.visible={update:function(n,t){var i=l.a.d(t()),r="none"!=n.style.display;i&&!r?n.style.display="":!i&&r&&(n.style.display="none")}},l.c.click={init:function(n,t,i,r){return l.c.event.init.call(this,n,function(){var n={};return n.click=t(),n},i,r)}},l.v=function(){},l.v.prototype.renderTemplateSource=function(){u(Error("Override renderTemplateSource"))},l.v.prototype.createJavaScriptEvaluatorBlock=function(){u(Error("Override createJavaScriptEvaluatorBlock"))},l.v.prototype.makeTemplateSource=function(n,t){if("string"==typeof n){t=t||e;var i=t.getElementById(n);return i||u(Error("Cannot find template with ID "+n)),new l.l.h(i)}if(1==n.nodeType||8==n.nodeType)return new l.l.O(n);u(Error("Unknown template type: "+n))},l.v.prototype.renderTemplate=function(n,t,i,r){return n=this.makeTemplateSource(n,r),this.renderTemplateSource(n,t,i)},l.v.prototype.isTemplateRewritten=function(t,r){return this.allowTemplateRewriting===i?n:this.makeTemplateSource(t,r).data("isRewritten")},l.v.prototype.rewriteTemplate=function(t,i,r){t=this.makeTemplateSource(t,r),i=i(t.text()),t.text(i),t.data("isRewritten",n)},l.b("templateEngine",l.v),kt=/(<[a-z]+\d*(\s+(?!data-bind=)[a-z0-9\-]+(=(\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind=(["'])([\s\S]*?)\5/gi,dt=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g,l.za={vb:function(n,t,i){t.isTemplateRewritten(n,i)||t.rewriteTemplate(n,function(n){return l.za.Gb(n,t)},i)},Gb:function(n,t){return n.replace(kt,function(n,i,r,u,f,e,o){return st(o,i,t)}).replace(dt,function(n,i){return st(i,"<!-- ko -->",t)})},kb:function(n){return l.s.ra(function(t,i){t.nextSibling&&l.Fa(t.nextSibling,n,i)})}},l.b("__tr_ambtns",l.za.kb),l.l={},l.l.h=function(n){this.h=n},l.l.h.prototype.text=function(){var n=l.a.u(this.h),n="script"===n?"text":"textarea"===n?"value":"innerHTML",t;if(0==arguments.length)return this.h[n];t=arguments[0],"innerHTML"===n?l.a.ca(this.h,t):this.h[n]=t},l.l.h.prototype.data=function(n){if(1===arguments.length)return l.a.f.get(this.h,"templateSourceData_"+n);l.a.f.set(this.h,"templateSourceData_"+n,arguments[1])},l.l.O=function(n){this.h=n},l.l.O.prototype=new l.l.h,l.l.O.prototype.text=function(){if(0==arguments.length){var n=l.a.f.get(this.h,"__ko_anon_template__")||{};return n.Aa===r&&n.ia&&(n.Aa=n.ia.innerHTML),n.Aa}l.a.f.set(this.h,"__ko_anon_template__",{Aa:arguments[0]})},l.l.h.prototype.nodes=function(){if(0==arguments.length)return(l.a.f.get(this.h,"__ko_anon_template__")||{}).ia;l.a.f.set(this.h,"__ko_anon_template__",{ia:arguments[0]})},l.b("templateSources",l.l),l.b("templateSources.domElement",l.l.h),l.b("templateSources.anonymousTemplate",l.l.O),l.wa=function(n){n==r||n instanceof l.v||u(Error("templateEngine must inherit from ko.templateEngine")),rt=n},l.va=function(n,i,f,e,o){if(f=f||{},(f.templateEngine||rt)==r&&u(Error("Set a template engine before calling renderTemplate")),o=o||"replaceChildren",e){var s=d(e);return l.j(function(){var t=i&&i instanceof l.z?i:new l.z(l.a.d(i)),r="function"==typeof n?n(t.$data,t):n,t=ft(e,o,r,t,f);"replaceNode"==o&&(e=t,s=d(e))},t,{Ka:function(){return!s||!l.a.X(s)},W:s&&"replaceNode"==o?s.parentNode:s})}return l.s.ra(function(t){l.va(n,i,f,t,"replaceNode")})},l.Mb=function(n,i,u,f,e){function s(n,t){et(t,o),u.afterRender&&u.afterRender(t,n)}function h(i,r){o=e.createChildContext(l.a.d(i),u.as),o.$index=r;var f="function"==typeof n?n(i,o):n;return ft(t,"ignoreTargetNode",f,o,u)}var o;return l.j(function(){var n=l.a.d(i)||[];"undefined"==typeof n.length&&(n=[n]),n=l.a.fa(n,function(n){return u.includeDestroyed||n===r||n===t||!l.a.d(n._destroy)}),l.r.K(l.a.$a,t,[f,n,h,u,s])},t,{W:f})},l.c.template={init:function(t,i){var r=l.a.d(i());return"string"==typeof r||r.name||1!=t.nodeType&&8!=t.nodeType||(r=1==t.nodeType?t.childNodes:l.e.childNodes(t),r=l.a.Hb(r),new l.l.O(t).nodes(r)),{controlsDescendantBindings:n}},update:function(i,u,f,e,o){u=l.a.d(u()),f={},e=n;var s,h=t;"string"!=typeof u&&(f=u,u=f.name,"if"in f&&(e=l.a.d(f["if"])),e&&"ifnot"in f&&(e=!l.a.d(f.ifnot)),s=l.a.d(f.data)),"foreach"in f?h=l.Mb(u||i,e&&f.foreach||[],f,i,o):e?(o="data"in f?o.createChildContext(s,f.as):o,h=l.va(u||i,o,f,i)):l.e.Y(i),o=h,(s=l.a.f.get(i,"__ko__templateComputedDomDataKey__"))&&"function"==typeof s.B&&s.B(),l.a.f.set(i,"__ko__templateComputedDomDataKey__",o&&o.pa()?o:r)}},l.g.Q.template=function(n){return n=l.g.aa(n),1==n.length&&n[0].unknown||l.g.Eb(n,"name")?t:"This template engine does not support anonymous templates nested within its templates"},l.e.I.template=n,l.b("setTemplateEngine",l.wa),l.b("renderTemplate",l.va),l.a.Ja=function(n,t,i){return n=n||[],t=t||[],n.length<=t.length?ut(n,t,"added","deleted",i):ut(t,n,"deleted","added",i)},l.b("utils.compareArrays",l.a.Ja),l.a.$a=function(t,i,u,f,e){function rt(n,t){o=b[t],g!==t&&(tt[n]=o),o.na(g++),k(o.M),d.push(o),v.push(o)}function a(n,t){if(n)for(var i=0,r=t.length;i<r;i++)t[i]&&l.a.o(t[i].M,function(r){n(r,i,t[i].U)})}var s,w,ut;i=i||[],f=f||{};var w=l.a.f.get(t,"setDomNodeChildrenFromArrayMapping_lastMappingResult")===r,b=l.a.f.get(t,"setDomNodeChildrenFromArrayMapping_lastMappingResult")||[],it=l.a.V(b,function(n){return n.U}),h=l.a.Ja(it,i),d=[],c=0,g=0,nt=[],v=[];i=[];for(var tt=[],it=[],o,s=0,y,p;y=h[s];s++)switch(p=y.moved,y.status){case"deleted":p===r&&(o=b[c],o.j&&o.j.B(),nt.push.apply(nt,k(o.M)),f.beforeRemove&&(i[s]=o,v.push(o))),c++;break;case"retained":rt(s,c++);break;case"added":p!==r?rt(s,p):(o={U:y.value,na:l.m(g++)},d.push(o),v.push(o),w||(it[s]=o))}for(a(f.beforeMove,tt),l.a.o(nt,f.beforeRemove?l.A:l.removeNode),s=0,w=l.e.firstChild(t);o=v[s];s++){for(o.M||l.a.extend(o,gt(t,u,o.U,e,o.na)),c=0;h=o.M[c];w=h.nextSibling,ut=h,c++)h!==w&&l.e.Pa(t,h,ut);!o.Ab&&e&&(e(o.U,o.M,o.na),o.Ab=n)}a(f.beforeRemove,i),a(f.afterMove,tt),a(f.afterAdd,it),l.a.f.set(t,"setDomNodeChildrenFromArrayMapping_lastMappingResult",d)},l.b("utils.setDomNodeChildrenFromArrayMapping",l.a.$a),l.C=function(){this.allowTemplateRewriting=i},l.C.prototype=new l.v,l.C.prototype.renderTemplateSource=function(i){var r=!(9>l.a.Z)&&i.nodes?i.nodes():t;return r?l.a.L(r.cloneNode(n).childNodes):(i=i.text(),l.a.ta(i))},l.C.oa=new l.C,l.wa(l.C.oa),l.b("nativeTemplateEngine",l.C),l.qa=function(){var n=this.Db=function(){if("undefined"==typeof f||!f.tmpl)return 0;try{if(0<=f.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(n){}return 1}();this.renderTemplateSource=function(i,r,o){o=o||{},2>n&&u(Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later."));var s=i.data("precompiled");return s||(s=i.text()||"",s=f.template(t,"{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}"),i.data("precompiled",s)),i=[r.$data],r=f.extend({koBindingContext:r},o.templateOptions),r=f.tmpl(s,i,r),r.appendTo(e.createElement("div")),f.fragments={},r},this.createJavaScriptEvaluatorBlock=function(n){return"{{ko_code ((function() { return "+n+" })()) }}"},this.addTemplate=function(n,t){e.write("<script type='text/html' id='"+n+"'>"+t+"<\/script>")},0<n&&(f.tmpl.tag.ko_code={open:"__.push($1 || '');"},f.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},l.qa.prototype=new l.v,h=new l.qa,0<h.Db&&l.wa(h),l.b("jqueryTmplTemplateEngine",l.qa)}var n=!0,t=null,i=!1,o=window,e=document,c=navigator,f=window.jQuery,r=void 0;"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?h(module.exports||exports):"function"==typeof define&&define.amd?define(["exports"],h):h(o.ko={}),n})(),function(n){"use strict";var i={},r=OK.tools.tracking;i.settings={},i.checkOutControl,i.checkInControl,i.calendarCheckOut,i.calendarCheckIn,i.isRestore=!1,i.isAutoset=!1,i.settings.global={},n.init=function(n,t){n.jcarousel(t||{})}}(OK.namespace("tools.carousel"),jQuery),function(n,t){"use strict";var i={},r=OK.tools.tracking;i.settings={},i.checkOutControl,i.checkInControl,i.calendarCheckOut,i.calendarCheckIn,i.isRestore=!1,i.isAutoset=!1,i.settings.global={firstDay:1,monthSelector:!1,monthPrev:"←",monthNext:"→",weekdaysShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekdaysFull:["вс","пн","вт","ср","чт","пт","сб"],monthsShort:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],monthsFull:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dateMin:!0,dateMax:365,format:"d mmm, dddd",formatSubmit:"yyyy/mm/dd"},i.settings.checkIn={onSelect:function(){t(".js-checkIn").data("pickadate").close(),i.isAutoset?i.isAutoset=!1:r.GA_TrackEvent("Destination Search","CheckInSet",oapText,null,!0);var n=this.getDate("yyyy, mm, dd").split(","),u={dateMin:[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)+1]};i.setCheckOutOffset(u),new Date(this.getDate("yyyy/mm/dd"))>=new Date(i.calendarCheckOut.getDate("yyyy/mm/dd"))&&(i.isAutoset=!0,i.calendarCheckOut.setDate(parseInt(n[0]),parseInt(n[1]),parseInt(n[2])+1),i.checkOutControl.change(),i.isRestore?i.isRestore=!1:i.openCheckOut()),setTimeout(function(){i.calendarCheckIn.close()},100)}},i.settings.checkOut={onSelect:function(){i.isAutoset?i.isAutoset=!1:(r.GA_TrackEvent("Destination Search","CheckOutSet",oapText,null,!0),setTimeout(function(){i.calendarCheckOut.close()},100))}},i.openCheckOut=function(){i.calendarCheckOut.open()},i.setCheckOutOffset=function(n){i.calendarCheckOut.setDateLimit(n.dateMin)},i.initCheckOut=function(n,t){var r=n.pickadate(t,i.settings.global);i.calendarCheckOut=r.data("pickadate")},i.initCheckIn=function(n){var u=n.pickadate(t.extend(i.settings.checkIn,i.settings.global));i.calendarCheckIn=u.data("pickadate")},i.getDateArray=function(n){for(var r=n.split("."),t=[],u,i=0;i<r.length;i++)t.push(parseInt(r[i]));return u=t[0],t[0]=t[2],t[2]=u,t},n.initInSearchForm=function(n,r){i.checkOutControl=r,i.checkInControl=n,i.initCheckIn(n,t.extend(!0,i.settings.checkIn,i.settings.global)),i.initCheckOut(r,t.extend(!0,i.settings.checkOut,i.settings.global))},n.getErrors=function(){var t=Date.parse(i.calendarCheckIn.getDate("yyyy/mm/dd")),u=Date.parse(i.calendarCheckOut.getDate("yyyy/mm/dd")),f="",e;return t&&u&&t>=u&&(f="Дата заезда должна быть раньше даты выезда",r.OA_TrackAction(74,null,"in="+n.getCheckInDate()+"&out="+n.getCheckOutDate())),t&&u&&(e=(u-t)/864e5,e>30&&(f="Бронирование возможно на срок до 30 дней. <br/>Пожалуйста, уменьшите срок проживания, чтобы продолжить поиск.",r.GA_TrackEvent("Destination Search","ValidationErrorMoreThan30Days",oapText,null,!0),r.OA_TrackAction(74,null,"in="+n.getCheckInDate()+"&out="+n.getCheckOutDate()))),f},n.getCheckInDate=function(n){return i.calendarCheckIn.getDate(n)},n.getCheckOutDate=function(n){return i.calendarCheckOut.getDate(n)},n.setCheckInDate=function(n){var r=i.getDateArray(n);i.isRestore=!0,i.isAutoset=!0,i.calendarCheckIn.setDate(r[0],r[1],r[2])},n.setCheckOutDate=function(n){var r=i.getDateArray(n);i.isAutoset=!0,i.calendarCheckOut.setDate(r[0],r[1],r[2])}}(OK.namespace("tools.calendar"),jQuery),function(n,t){function h(n,i){if(!n)return"";var r=new RegExp("("+t.ui.autocomplete.escapeRegex(i)+")","ig");return n.replace(r,"<strong>$1<\/strong>")}var i={},l=OK.tools.tracking,nt=OK.general,a,s=[],r=[],u="loc",e="locHeader",f="hotel",o="hotelHeader",v="ok_ac",y="ok_hotel_ac",p=".2e10.net",w=[e,u,o,f],b;n.autocompleteLoading=0,n.autocompleteSelectedOption=i.autocompleteSelectedOption,n.showClearLink=function(){i.btnClose.is(":hidden")&&(n.hideAllLinks(),i.btnClose.show(),i.destination.watermark())},n.showLoadingLink=function(){var t=i.frm.find(".js-btnLoader");t.is(":hidden")&&(n.hideAllLinks(),t.show())},n.hideAllLinks=function(){i.frm.find(".b-form-elem_validation-icon").hide()},n.saveAutocompleteOption=function(){var e,h,n,o,s;if(i.autocompleteSelectedOption!=null){e=i.autocompleteSelectedOption,e.timestamp=new Date,h=null;for(n in r)if(r[n].text&&r[n].text.toLowerCase()===e.text.toLowerCase()&&(r[n].objType==u&&r[n].id===Number(e.id)||r[n].objType==f&&r[n].hotelId===Number(e.hotelId))){h=n;break}h!=null?r[h].timestamp=e.timestamp:r.push(e),o=[],s=[],t.each(r,function(){this.objType==u?o.push(this):this.objType==f&&s.push(this)}),o.sort(c),s.sort(c),o.length>10&&(o=o.splice(0,10)),s.length>10&&(s=s.splice(0,10)),t.cookie(v,d(o,u),{expires:1825,path:"/",domain:p,secure:!1}),t.cookie(y,d(s,f),{expires:1825,path:"/",domain:p,secure:!1})}};var c=function(n,t){return n.timestamp<t.timestamp?1:n.timestamp>t.timestamp?-1:0},k=function(n,i){var r=t.inArray(n.objType,w),u=t.inArray(i.objType,w);return r>u?1:r<u?-1:c(n,i)},d=function(n,t){for(var r="",i,e=0;e<n.length;e++)i=n[e],r!=""&&(r+="~"),t==u?r+=i.text.toLowerCase()+"|"+i.value+"|"+i.country+"||"+i.id+"|"+i.timestamp.getUTCFullYear()+"|"+i.timestamp.getUTCMonth()+"|"+i.timestamp.getUTCDate()+"|"+i.timestamp.getUTCHours()+"|"+i.timestamp.getUTCMinutes()+"|"+i.timestamp.getUTCSeconds():t==f&&(r+=i.text.toLowerCase()+"|"+i.value+"|"+i.locationName+"|"+i.hotelId+"|"+i.timestamp.getUTCFullYear()+"|"+i.timestamp.getUTCMonth()+"|"+i.timestamp.getUTCDate()+"|"+i.timestamp.getUTCHours()+"|"+i.timestamp.getUTCMinutes()+"|"+i.timestamp.getUTCSeconds());return r},g=function(n,t){var o=[],e,s,i,r;if(typeof n!="undefined"&&n!=null&&n.length>0)for(e=n.split("~"),s=0;s<e.length;e++)i=e[s].split("|"),t==u?(r=new Date(0),r.setUTCFullYear(i[5]),r.setUTCMonth(i[6]),r.setUTCDate(i[7]),r.setUTCHours(i[8]),r.setUTCMinutes(i[9]),r.setUTCSeconds(i[10]),o.push({objType:t,text:i[0],value:i[1],country:i[2],id:Number(i[4]),timestamp:r})):t==f&&(r=new Date(0),r.setUTCFullYear(i[4]),r.setUTCMonth(i[5]),r.setUTCDate(i[6]),r.setUTCHours(i[7]),r.setUTCMinutes(i[8]),r.setUTCSeconds(i[9]),o.push({objType:t,text:i[0],value:i[1],locationName:i[2],hotelId:Number(i[3]),timestamp:r}));return o};n.init=function(p,w,d,tt){b=typeof d.destAutoComplUrl!="undefined"?d.destAutoComplUrl:"",i.frm=tt,i.destinationHidden=i.frm.find("#searchDestination"),i.destination=i.frm.find(".js-dest"),i.destinationId=i.frm.find("#searchDestinationId"),i.btnClose=i.frm.find("a.btnClose"),i.hotelId="",n.destination=i.destination,n.hotelId,a=OK.searchForm,n.destinationText="",i.btnClose.click(function(){return i.destination.wval(""),OK.searchForm.checkDestinationKey(),!1}),r=g(t.cookie(v),u);var it=g(t.cookie(y),f);t.each(it,function(){r.push(this)}),r.sort(c),p.autocomplete({appendTo:w,messages:{noResults:"",results:function(){}},source:function(c,l){var y=t.trim(c.term).replace(new RegExp("\\s+","g")," "),nt,a;if(y.length!=0)if(c.term=y,y in s)l(s[y]);else{var tt=y.toLowerCase(),rt=[],v=[],it={};it.locationList=[],it.hotelList=[];var d=[],g=[],p=0,w=0;for(nt in r)if(a=r[nt],a.objType==u&&a.text.indexOf(tt)!=-1&&!(a.id in d)&&(v.push({objType:u,label:h(a.value.replace(OK.searchForm.destinationSplitPattern,""),c.term),value:a.value,id:a.id,hotelsCount:a.hotelsCount,country:a.country,timestamp:a.timestamp}),d[a.id]=v.length-1,p++,p==5))break;for(nt in r)if(a=r[nt],a.objType==f&&a.text.indexOf(tt)!=-1&&!(a.hotelId in g)&&(v.push({objType:f,label:h(a.value.replace(OK.searchForm.destinationSplitPattern,""),c.term),value:a.value,hotelId:a.hotelId,locationName:a.locationName,timestamp:a.timestamp}),g[a.hotelId]=1,w++,w==5))break;s[y]=v,y.length>2&&(p<5||w<5)?(n.autocompleteLoading==0&&n.showLoadingLink(),n.autocompleteLoading++,t.ajax({url:b,dataType:"json",data:c,success:function(n){var i,t;for(i in n.locationList)if(t=n.locationList[i],t.id in d)d[t.id]!=-1&&(v[d[t.id]].hotelsCount=t.hotelsCount);else if(v.push({objType:u,label:h(t.value,c.term),value:t.value+", "+t.country,id:t.id,hotelsCount:t.hotelsCount,country:t.country,timestamp:0}),d[t.id]=-1,p++,p==5)break;for(i in n.hotelList)if(t=n.hotelList[i],!(t.hotelId in g)&&(v.push({objType:f,label:h(t.value,c.term),value:t.value+", "+t.locationName,hotelId:t.hotelId,locationName:t.locationName,timestamp:0}),g[t.hotelId]=1,w++,w==5))break;s[y]=v,p!=0&&v.push({objType:e}),w!=0&&v.push({objType:o}),v.sort(k),l(v)},complete:function(){n.autocompleteLoading--,n.autocompleteLoading==0&&(i.destination.val().length>0?n.showClearLink():n.hideAllLinks())}})):(p!=0&&v.push({objType:e}),w!=0&&v.push({objType:o}),v.sort(k),l(v))}},minLength:0,delay:300,open:function(){var r=t(this).data("uiAutocomplete").menu;!r.element.children()||r.element.children().length<2},select:function(t,r){if(r.item){switch(r.item.objType){case e:i.destinationId.attr("value",""),n.destinationText="",i.autocompleteSelectedOption={objType:r.item.objType};break;case o:i.destinationId.attr("value",""),n.destinationText="",i.autocompleteSelectedOption={objType:r.item.objType};break;case u:i.destinationId.attr("value",r.item.id),i.hotelId=null,n.destinationText=r.item.value,i.autocompleteSelectedOption={objType:r.item.objType,value:r.item.value,id:r.item.id,hotelsCount:r.item.hotelsCount,country:r.item.country,text:i.destination.val()},l.GA_TrackEvent("Destination Search","SuggestUsedDest",oapText,null,!0);break;case f:i.destinationId.attr("value",""),i.hotelId=r.item.hotelId,n.hotelId=i.hotelId,n.destinationText=r.item.value,i.autocompleteSelectedOption={objType:r.item.objType,value:r.item.value,hotelId:r.item.hotelId,locationName:r.item.locationName,text:i.destination.val()},l.GA_TrackEvent("Destination Search","SuggestUsedHotel",oapText,null,!0)}i.isDestinationChanged=!0,a.fireDestinationChangedEvent()}}}).data("uiAutocomplete")._renderItem=function(n,i){var r="",h='<a class="b-menu_item_inner b-menu_link"><\/a>',s="",c;switch(i.objType){case e:h='<span class="b-menu_item_inner b-menu_subtitle"><\/span>',s="item-type-location item-type-title",r="Города";break;case o:h='<span class="b-menu_item_inner b-menu_subtitle"><\/span>',s="item-type-hotel item-type-title",r="Отели";break;case u:s="item-type-location",r=i.label+", "+i.country+(i.hotelsCount!=undefined?'<span class="b-menu_item_sidebar">'+i.hotelsCount+" "+nt.declOfNum(i.hotelsCount,["отель","отеля","отелей"])+"<\/span>":"");break;case f:s="item-type-hotel",r=i.label+', <span class="b-menu_item_description">'+i.locationName+"<\/span>"}return r.indexOf("undefined")==-1&&(c="",t('<li class="b-menu_item '+s+c+' "><\/li>').data("ui-autocomplete-item",i).append(t(h).html(r)).appendTo(n)),n}}}(OK.namespace("tools.autocomplete"),jQuery),function(n,t,i){"use strict";var f=OK.tools.calendar,u=OK.tools.autocomplete,e=OK.tools.tooltip,o,r={};r.params,r.searchHelper,r.destinationText,r.formName,r.cookieName="wls_search_params",r.cDomain=".2e10.net",r.dateFormat="dd.mm.yyyy",r.restoredRoomsState,r.eventsAreSubscribed=!1,r.tooltipSettings={position:{my:"bottom center",at:"top right"},events:{show:function(){t(this).qtip("options","position.adjust.x",-(t(this).width()/2))}},style:{classes:"qtip-2e10 qtip-2e10-dest",tip:{height:7,width:33}}},n.frm,r.checkIn,r.checkOut,r.destination,r.acContainer,r.frm,r.destinationId,r.hotelId=null,r.isDestinationChanged=!1,r.$searchCheckInDate=t("#searchCheckInDate"),r.$searchCheckOutDate=t("#searchCheckOutDate"),r.isValid=!0,r.initLocalVariables=function(i){r.params=i,r.formName=typeof i.formName!="undefined"?i.formName:"frmSearch",r.frm=t("#"+r.formName),r.checkIn=r.frm.find(".js-checkIn"),r.checkOut=r.frm.find(".js-checkOut"),r.destination=r.frm.find(".js-dest"),r.acContainer=r.frm.find(".js-acContainer"),r.destinationId=r.frm.find("#searchDestinationId"),r.searchHelper=new OK.searchForm.SearchHelper,r.frm.submit(r.prepareToSubmit),o=OK.searchForm.rooms,n.frm=r.frm},r.submitForm=function(){if(r.isValid){var n=t.param.querystring(r.frm.attr("action"),r.searchHelper.getQueryString());typeof globalSettings!="undefined"&&globalSettings.postParameters?window.parent&&window.parent.postMessage(r.searchHelper.getQueryString(),globalSettings.postParametersAllowedUrl):setTimeout(function(){window.location.href=n},100)}},r.subscribeOnEvents=function(){var n=t.data(r.frm[0],"validator").settings,u=n.errorPlacement,f=n.success;n.errorPlacement=function(n,t){n.text()&&(i.GA_TrackEvent("Destination Search","ValidationErrorNoDest",oapText,null,!0),i.OA_TrackAction(74,null,"dest=null"),r.tooltipSettings.content={text:n.text()},e.show(t,t,r.tooltipSettings))},n.success=function(n,i){e.remove(t(i)),r.isValid=!0}},r.prepareToSubmit=function(n){if(n.preventDefault(),r.eventsAreSubscribed||(r.subscribeOnEvents(),r.eventsAreSubscribed=!0),r.tooltipSettings.content={text:f.getErrors()},r.tooltipSettings.content.text?(r.isCalendValid=!1,r.isValid=!1,e.show(r.checkIn,r.checkOut,r.tooltipSettings)):(r.isCalendValid=!0,e.remove(r.checkIn)),r.frm.valid()&&r.isCalendValid){u.hotelId&&(r.hotelId=u.hotelId);var t={startDate:f.getCheckInDate(r.dateFormat),endDate:f.getCheckOutDate(r.dateFormat),destination:r.destination.val(),destinationId:r.destinationId.val(),hotelId:r.hotelId,rooms:ko.toJS(o.roomsState)};return r.$searchCheckInDate.val(t.startDate),r.$searchCheckOutDate.val(t.endDate),r.searchHelper.setSearchHelperData(t),r.saveData(),i.OA_TrackAction(2,null,r.searchHelper.getQueryString()),r.submitForm(),!1}return r.isValid=!1,!1},r.saveData=function(){t.cookie(r.cookieName,r.searchHelper.getQueryString(),{expires:30,path:"/",domain:r.cDomain,secure:!1}),u.saveAutocompleteOption()},r.initCalendar=function(){f.initInSearchForm(r.checkIn,r.checkOut)},r.initHints=function(){/\S/.test(u.destination.val())||u.destination.watermark(),/\S/.test(r.checkIn.val())||r.checkIn.watermark(),/\S/.test(r.checkOut.val())||r.checkOut.watermark()},n.fireDestinationChangedEvent=function(){},r.restoreData=function(){var e=window.location.search,o=e!=""&&e.toLowerCase().indexOf("in=")>-1,i=o?e:t.cookie(r.cookieName),n;i?(i.indexOf("?")==0&&(i=i.substring(1)),n=r.searchHelper.parseQueryString(i),f.setCheckInDate(n.checkIn,!0),f.setCheckOutDate(n.checkOut,!0),n.destination&&(u.destination.val(n.destination),u.showClearLink()),r.restoredRoomsState=n.rooms,r.destinationId.val(n.destinationId),r.hotelId=n.hotelId):f.setCheckInDate((new Date).getDate()+1+"."+((new Date).getMonth()+1)+"."+(new Date).getFullYear(),!0)},n.SearchControl=function(i){r.initLocalVariables(i),u.init(r.destination,r.acContainer,i,r.frm),r.initCalendar(i),r.restoreData(),o.init(r.restoredRoomsState),r.initHints(),u.destination.bind("keyup keypress",n.checkDestinationKey),u.destination.bind("cut copy paste mousedown",function(){setTimeout(n.checkDestinationKey,4)}),u.destination.bind("blur",function(){if(setTimeout(n.checkDestinationKey,4),r.frm.valid())r.isValid=!0,e.remove(r.destination);else{var i=t.data(r.frm[0],"validator").settings,u=i.messages.dest.required;r.tooltipSettings.content={text:t.trim(r.destination.val()).length!=0?"":u},r.tooltipSettings.content.text&&(r.isValid=!1,e.show(r.destination,r.destination,r.tooltipSettings))}})},n.checkDestinationKey=function(t){if(typeof t!="undefined"&&typeof t.keyCode!="undefined"&&t.keyCode=="13")return r.destination.autocomplete("close"),t.preventDefault(),r.checkIn.focus(),!1;(r.destination.val()==""||u.destinationText!=r.destination.val())&&(r.destinationId.val(""),r.hotelId=null,u.autocompleteSelectedOption=null,r.isDestinationChanged=!0,r.destination.val().length>0?u.autocompleteLoading==0&&u.showClearLink():u.autocompleteLoading==0&&u.hideAllLinks(),n.fireDestinationChangedEvent(),u.destinationText=r.destination.val())}}(OK.namespace("searchForm"),jQuery,OK.namespace("tools.tracking")),function(n,t,i){var u=OK.searchForm,r={};n.maxRoomsCount=4,r.adultsCount=6,r.childsCount=4,r.maxChildAge=18,r.roomsSelected=1,r.defaultAdults=2,r.isFirstRender=!0,n.adultsOpt=function(){for(var t=[],n=1;n<r.adultsCount+1;n++)t.push({val:n,text:n+(n==1?" взрослый":" взрослых")});return t}(),n.childsAgeOpt=function(){for(var t=[],n=0;n<r.maxChildAge+1;n++)t[n]=n;return t}(),n.childsOpt=function(){for(var i=[],t,n=0;n<r.childsCount+1;n++){t="";switch(n){case 0:t+=" без детей";break;case 1:t+=" и 1 ребенок";break;default:t+=" и "+n+" детей"}i.push({val:n,text:t,selected:1})}return i}(),r.initRoomsState=function(){for(var t=0;t<r.roomsSelected;t++)n.roomsState.push({adultsCount:ko.observable(r.defaultAdults),childrenAges:ko.observableArray()})},n.roomsState=ko.observableArray(),r.roomsHolder,r.frm,r.adults={},r.initLocalVariables=function(){r.frm=u.frm,r.roomsHolder=r.frm.find(".js-rooms")},r.restoreRoomsState=function(t){for(var i=0;i<t.length;i++)n.roomsState.push({adultsCount:ko.observable(t[i].adultsCount),childrenAges:ko.observableArray(t[i].childrenAges)})},n.childsSelected=function(){for(var t=0;t<n.roomsState().length;t++)if(n.roomsState()[t].childrenAges().length>0)return!0;return!1},n.init=function(n){r.initLocalVariables(),n?r.restoreRoomsState(n):r.initRoomsState()},n.addroom=function(){i.GA_TrackEvent("Destination Search","RoomAdd",oapText,null,!0),n.roomsState.push({adultsCount:ko.observable(r.defaultAdults),childrenAges:ko.observableArray()})},n.removeRoom=function(){i.GA_TrackEvent("Destination Search","RoomRemove",oapText,null,!0),n.roomsState.remove(this)},n.applyUniform=function(){for(var f=r.frm.find(".js-uniform"),u=0;u<f.length;u++)t(f[u]).hasClass("js-uniform-applied")||t(f[u]).uniform().addClass("js-uniform-applied")},n.childsChange=function(n,t){for(var o=t.currentTarget.value,e=n.childrenAges(),u=[],f,r=0;r<e.length;r++)u.push(e[r]);for(r=0;r<o;r++)u[r]||(u[r]=0);for(u.length>r&&u.splice(r,u.length-r),i.GA_TrackEvent("Destination Search","KidsSet",oapText,null,!0),n.childrenAges.removeAll(),f=0;f<u.length;f++)n.childrenAges.push(u[f])},n.childsAgeChange=function(n,t){var r=this[1],u=this[0](),f=t.currentTarget.value,i=[];i=r.childrenAges(),i[u]=parseInt(f)},n.adultsChange=function(){i.GA_TrackEvent("Destination Search","AdultsSet",oapText,null,!0)}}(OK.namespace("searchForm.rooms"),jQuery,OK.namespace("tools.tracking")),function(n,t){n.destinationSplitPattern=/,.+/g,n.SearchHelper=function(n){function b(n){for(var t=[],r,f=n.slice(n.indexOf("?")+1).split("&"),i,u=0;u<f.length;u++)r=f[u].split("="),i=r[0].toLowerCase(),t[i]!=undefined?(t[i]=[t[i]],t[i].push(r[1])):t[i]=r[1];return t}var i=this;this.destinationId,this.checkIn,this.checkOut,this.ticket,this.rooms,this.destination,this.hotelId,this.setSearchHelperData=function(n){i.destination=n.destination,i.destinationId=n.destinationId,i.hotelId=n.hotelId,i.checkIn=n.startDate,i.checkOut=n.endDate,i.rooms=n.rooms},this.getQueryString=function(){var n="",e,h,o,t,s,f;if(n=u(r.checkIn,i.checkIn,n),n=u(r.checkOut,i.checkOut,n),n=u(r.destinationId,i.destinationId,n),n=u(r.ticket,i.ticket,n),n=u(r.hotelId,i.hotelId,n),i.destination!=undefined&&i.destination!=""?(e=encodeURIComponent(i.destination),e=e.replace(/%/g,"_"),n=u(r.destination,e,n)):(h=i.destination.match(OK.searchForm.destinationSplitPattern)||"",h.length>0&&(o=encodeURIComponent(h[0]),o=o.replace(/%/g,"_"),n=u(r.destination,o,n))),t="",i.rooms!=null&&i.rooms.length>0){for(s=0;s<i.rooms.length;s++)f=i.rooms[s],t.length>0&&(t+=";"),f.adultsCount&&(t+=f.adultsCount.toString()),f.childrenAges!=undefined&&f.childrenAges.length>0&&(t+="."+f.childrenAges.join("."));n=u(r.occupancy,t,n)}return n},this.getOldQueryString=function(){var n="",v,h,y,c,t,r,f,s,p,a;n=u(e.checkIn,i.checkIn,n),n=u(e.checkOut,i.checkOut,n),n=u(e.destinationId,i.destinationId,n),n=u(e.ticket,i.ticket,n),n=u(e.hotelId,i.hotelId,n);for(v in o)n=u(v,o[v],n);if(i.destination!=undefined&&i.destination!=""&&(h=encodeURIComponent(i.destination.replace(OK.searchForm.destinationSplitPattern,"")),h=h.replace(/%/g,"_"),n=u(e.destination,h,n)),i.destination!=undefined&&i.destination!=""&&(y=i.destination.match(OK.searchForm.destinationSplitPattern)||"",y.length>0&&(c=encodeURIComponent(y[0]),c=c.replace(/%/g,"_"),n=u(e.country,c,n))),t="",i.rooms!=null&&i.rooms.length>0){for(r=0;r<i.rooms.length;r++){for(f=i.rooms[r],s=0,p=0;p<f.adultsCount;p++)t.length>0&&(t+="&"),t+=l(r,s,31,!1),s++;if(f.childrenAges!=undefined&&f.childrenAges.length>0)for(a=0;a<f.childrenAges.length;a++)t+="&",t+=l(r,s,f.childrenAges[a],!0),s++}n.length>0&&(n+="&"),n+=t}return n},this.parseQueryString=function(n){return s=n,c(),i};var e={destinationId:"destinationid",checkIn:"checkindate",checkOut:"checkoutdate",ticket:"ticket",destination:"destination",hotelId:"hotelid",country:"country"},r={destinationId:"destid",checkIn:"in",checkOut:"out",ticket:"tckt",destination:"dest",occupancy:"occ",hotelId:"hid",country:"country"},s=n,o=[];o.language="ru",o.product="Hotel";var k="dd.mm.yyyy",c=function(){if(s!=undefined){var n=b(s);a(n)?v(n):y(n)}},u=function(n,t,i){return t!=undefined&&t!=null&&t!=""&&(i.length>0&&(i+="&"),i+=n+"="+t),i},a=function(n){for(var t in n)if(t==r.destinationId||t==r.checkIn||t==r.checkOut||t==r.ticket||t==r.destination||t==r.occupancy||t==r.hotelId||t==r.country)return!0;return!1},v=function(n){var t,u,e,o;i.destinationId=f(n,r.destinationId),t=f(n,r.checkIn),i.checkIn=t,t=f(n,r.checkOut),i.checkOut=t,i.ticket=f(n,r.ticket),i.hotelId=f(n,r.hotelId),u=f(n,r.destination),i.destination=h(u),e=f(n,r.country),i.country=h(e),o=f(n,r.occupancy),w(o)},y=function(n){var t,r;i.destinationId=f(n,e.destinationId),t=f(n,e.checkIn),i.checkIn=t,t=f(n,e.checkOut),i.checkOut=t,i.ticket=f(n,e.ticket),i.hotelId=f(n,e.hotelId),r=f(n,e.destination),i.destination=h(r),p(n)},h=function(n){return n!=""&&(n=n.replace(/_([0-9a-f][0-9a-f])/ig,"%$1"),n.indexOf("<")==-1&&n.indexOf("%3C")==-1)?decodeURIComponent(n):""},f=function(n,i){var r=n[i];if(r!=undefined)if(t.isArray(r))throw"Each key should appear only once";else return r;return""},p=function(n){var r=[],f,e,t,u,s,o,h;for(f in n)f.indexOf("room_")==0&&(e=f.split("_"),t=parseInt(e[1]),r[t]==undefined&&(r[t]=[]),u=parseInt(e[3]),r[t][u]==undefined&&(r[t][u]=[]),e[4]==="ischild"&&(r[t][u][0]=n[f].toLowerCase()),e[4]==="age"&&(r[t][u][1]=n[f]));i.rooms=[];for(t in r){s=r[t],o={adultsCount:0,childrenAges:[]};for(u in s)h=s[u],h[0]==="true"?o.childrenAges.push(parseInt(h[1])):o.adultsCount++;i.rooms.push(o)}},w=function(n){var u,e,f,t,r;if(i.rooms=[],n!=undefined&&n!=""){u=n.split(";");for(e in u)f=u[e],typeof f!="function"&&(t={adultsCount:0,childrenAges:[]},r=f.split("."),t.adultsCount=parseInt(r[0]),r.splice(0,1),t.childrenAges=r,i.rooms.push(t))}},l=function(n,t,i,r){var u="room_"+n.toString()+"_guest_"+t.toString()+"_";return u+"age="+i+"&"+u+"ischild="+r};c()}}(OK.namespace("searchForm"),jQuery),function(n){function t(n){var t=/[.]/.exec(n)?/[^.]+$/.exec(n):undefined;return t!=undefined?t[0]:t}n.validator.addMethod("alwaysvalid",function(t,i){var u=n(i),f=n.trim(u.val()),e=f!="";return u.val(f),u.data("show-sign",e),!0}),n.validator.unobtrusive.adapters.add("alwaysvalid",[],function(n){n.rules.alwaysvalid={},n.messages.alwaysvalid=""}),n.validator.addMethod("requiredif",function(t,i,r){var u=n("#"+r.other);u.length==0&&(u=n('[name$=".'+r.other+'"]'));var f=u.attr("type").toUpperCase()=="CHECKBOX"?u.attr("checked")?"true":"false":u.val().toLowerCase(),e=r.comp=="isequalto"?f==r.value:f!=r.value,o=n(i);return o.data("show-sign",e),!e||n.trim(o.val())!=""}),n.validator.unobtrusive.adapters.add("requiredif",["other","comp","value"],function(n){n.rules.requiredif={other:n.params.other,comp:n.params.comp,value:n.params.value},n.messages.requiredif=n.message}),n.validator.addMethod("regexif",function(t,i,r){var u=n("#"+r.other);u.length==0&&(u=n('[name$=".'+r.other+'"]'));var f=u.attr("type").toUpperCase()=="CHECKBOX"?u.attr("checked")?"true":"false":u.val().toLowerCase(),e=r.comp=="isequalto"?f==r.value:f!=r.value,o=n(i),s=o.val(),h=new RegExp(r.regex,"");return(o.data("show-sign",e),s=="")?!0:!e||h.test(s)}),n.validator.unobtrusive.adapters.add("regexif",["regex","other","comp","value"],function(n){n.rules.regexif={regex:n.params.regex,other:n.params.other,comp:n.params.comp,value:n.params.value},n.messages.regexif=n.message}),n.validator.addMethod("regexifelse",function(t,i,r){var u=n("#"+r.other);u.length==0&&(u=n('[name$=".'+r.other+'"]'));var f=u.attr("type").toUpperCase()=="CHECKBOX"?u.attr("checked")?"true":"false":u.val().toLowerCase(),s=r.comp=="isequalto"?f==r.value:f!=r.value,e=n(i),o=e.val(),h=new RegExp(r.regexiftrue,""),c=new RegExp(r.regexiffalse,"");return e.data("show-sign",!0),s?h.test(o):c.test(o)}),n.validator.unobtrusive.adapters.add("regexifelse",["regexiftrue","regexiffalse","other","comp","value"],function(n){n.rules.regexifelse={regexiftrue:n.params.regexiftrue,regexiffalse:n.params.regexiffalse,other:n.params.other,comp:n.params.comp,value:n.params.value},n.messages.regexifelse=n.message}),n.validator.unobtrusive.adapters.add("fileextensions",["fileextensions"],function(n){var t={fileextensions:n.params.fileextensions.split(",")};n.rules.fileextensions=t,n.message&&(n.messages.fileextensions=n.message)}),n.validator.addMethod("fileextensions",function(i,r,u){var f=t(i);return n.inArray(f,u.fileextensions)!==-1}),n.validator.unobtrusive.adapters.addBool("mandatory","required")}(jQuery),function(n){n.HomeViewModel=function(n){var t=this;t.SearchForm=OK.searchForm,t.Rooms=OK.searchForm.rooms,t.tooltip=OK.tools.tooltip,t.carousel=OK.tools.carousel,t.tooltipSettings={position:{my:"bottom center",at:"top right"},events:{show:function(){$(this).qtip("options","position.adjust.x",-($(this).width()/2))}},style:{classes:"qtip-2e10 qtip-2e10-dest",tip:{height:7,width:33}}},$.validator.setDefaults({onkeyup:!1,onfocusout:!1,ignore:".ignore"}),new t.SearchForm.SearchControl(n)}}(OK.namespace("viewModels"))